!function(e){function t(t){for(var n,i,r=t[0],a=t[1],l=0,s=[];l<r.length;l++)i=r[l],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&s.push(o[i][0]),o[i]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);for(c&&c(t);s.length;)s.shift()()}var n={},o={0:0};function i(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.e=function(e){var t=[],n=o[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,i){n=o[e]=[t,i]}));t.push(n[2]=r);var a,l=document.createElement("script");l.charset="utf-8",l.timeout=120,i.nc&&l.setAttribute("nonce",i.nc),l.src=function(e){return i.p+""+e+".main.js"}(e);var c=new Error;a=function(t){l.onerror=l.onload=null,clearTimeout(s);var n=o[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",c.name="ChunkLoadError",c.type=i,c.request=r,n[1](c)}o[e]=void 0}};var s=setTimeout((function(){a({type:"timeout",target:l})}),12e4);l.onerror=l.onload=a,document.head.appendChild(l)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var r=window.webpackJsonp=window.webpackJsonp||[],a=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var c=a;i(i.s=4)}([function(e,t,n){var o,i=i||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,n=function(){return e.URL||e.webkitURL||e},o=t.createElementNS("http://www.w3.org/1999/xhtml","a"),i="download"in o,r=/constructor/i.test(e.HTMLElement)||e.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent),l=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},c=function(e){setTimeout((function(){"string"==typeof e?n().revokeObjectURL(e):e.remove()}),4e4)},s=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},d=function(t,d,u){u||(t=s(t));var p,f=this,g="application/octet-stream"===t.type,m=function(){!function(e,t,n){for(var o=(t=[].concat(t)).length;o--;){var i=e["on"+t[o]];if("function"==typeof i)try{i.call(e,n||e)}catch(e){l(e)}}}(f,"writestart progress write writeend".split(" "))};if(f.readyState=f.INIT,i)return p=n().createObjectURL(t),void setTimeout((function(){var e,t;o.href=p,o.download=d,e=o,t=new MouseEvent("click"),e.dispatchEvent(t),m(),c(p),f.readyState=f.DONE}));!function(){if((a||g&&r)&&e.FileReader){var o=new FileReader;return o.onloadend=function(){var t=a?o.result:o.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,f.readyState=f.DONE,m()},o.readAsDataURL(t),void(f.readyState=f.INIT)}(p||(p=n().createObjectURL(t)),g)?e.location.href=p:e.open(p,"_blank")||(e.location.href=p);f.readyState=f.DONE,m(),c(p)}()},u=d.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=s(e)),navigator.msSaveOrOpenBlob(e,t)}:(u.abort=function(){},u.readyState=u.INIT=0,u.WRITING=1,u.DONE=2,u.error=u.onwritestart=u.onprogress=u.onwrite=u.onabort=u.onerror=u.onwriteend=null,function(e,t,n){return new d(e,t||e.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */e.exports?e.exports.saveAs=i:null!==n(2)&&null!==n(3)&&(void 0===(o=function(){return i}.call(t,n,t,e))||(e.exports=o))},function(e,t){
/*! @source http://purl.eligrey.com/github/canvas-toBlob.js/blob/master/canvas-toBlob.js */
!function(e){"use strict";var t,n=e.Uint8Array,o=e.HTMLCanvasElement,i=o&&o.prototype,r=/\s*;\s*base64\s*(?:;|$)/i,a="toDataURL",l=function(e){for(var o,i,r=e.length,a=new n(r/4*3|0),l=0,c=0,s=[0,0],d=0,u=0;r--;)i=e.charCodeAt(l++),255!==(o=t[i-43])&&void 0!==o&&(s[1]=s[0],s[0]=i,u=u<<6|o,4===++d&&(a[c++]=u>>>16,61!==s[1]&&(a[c++]=u>>>8),61!==s[0]&&(a[c++]=u),d=0));return a};n&&(t=new n([62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,0,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51])),!o||i.toBlob&&i.toBlobHD||(i.toBlob||(i.toBlob=function(e,t){if(t||(t="image/png"),this.mozGetAsFile)e(this.mozGetAsFile("canvas",t));else if(this.msToBlob&&/^\s*image\/png\s*(?:$|;)/i.test(t))e(this.msToBlob());else{var o,i=Array.prototype.slice.call(arguments,1),c=this[a].apply(this,i),s=c.indexOf(","),d=c.substring(s+1),u=r.test(c.substring(0,s));Blob.fake?((o=new Blob).encoding=u?"base64":"URI",o.data=d,o.size=d.length):n&&(o=u?new Blob([l(d)],{type:t}):new Blob([decodeURIComponent(d)],{type:t})),e(o)}}),!i.toBlobHD&&i.toDataURLHD?i.toBlobHD=function(){a="toDataURLHD";var e=this.toBlob();return a="toDataURL",e}:i.toBlobHD=i.toBlob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this)},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){"use strict";n.r(t);const o={id:"app-vertice",type:"symbol",source:"app-vertice",filter:["all",["has","cumulative_length"]],paint:{"text-color":"#000","text-halo-color":"#FFF","text-halo-width":2},layout:{"text-field":"aaa","text-field":["concat",["to-string",["/",["round",["*",100,["get","cumulative_length"]]],100]]," km"],"text-size":14,"text-font":["Noto Sans Regular"],"text-offset":[0,1],"text-allow-overlap":!1}},i={id:"app-end-circle",type:"circle",source:"app-vertice",filter:["all",["==","isEnd",!0]],paint:{"circle-radius":8,"circle-color":"#e74230"}},r=new URLSearchParams(window.location.search),a=e=>{r.set("g",e.geometry.coordinates.map(e=>e.join(",")).join(";")),window.history.replaceState({},"",`?${r.toString()}${window.location.hash}`),document.getElementById("url").value=window.location.href},l=async e=>{const t=await n.e(1).then(n.t.bind(null,5,7)),{coordinates:o}=e,i={type:"FeatureCollection",features:[{type:"Feature",properties:{cumulative_length:0,isEnd:!0},geometry:{type:"Point",coordinates:o[0]}}]};let r=0;for(let e=1;e<o.length;e++){const n=t.point(o[e-1]),a=t.point(o[e]);r+=t.distance(n,a),i.features.push({type:"Feature",properties:{cumulative_length:r,isEnd:e===o.length-1},geometry:{type:"Point",coordinates:o[e]}})}return{vertice:i,distance:r}};document.getElementById("clip").addEventListener("click",()=>{var e=document.getElementById("url");e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"),e.setSelectionRange(0,0),p("copy",!1,0),p("copied",!0,0),p("copied",!1,3e3)});const c=document.getElementById("wizard-trail"),s=document.getElementById("wizard-copy"),d=document.getElementById("wizard-copied"),u=document.getElementById("distance"),p=(e,t,n=0)=>{const o=t?"block":"none";let i=null;switch(e){case"trail":i=c;break;case"copy":i=s;break;case"copied":i=d}i&&setTimeout(()=>i.style.display=o,n)},f=e=>{let t="";t=e<1?Math.round(1e3*e)+" m":Math.round(100*e)/100+" km",u.innerText=t};n(1);var g=n(0),m=n.n(g);const y={loading:'\n  <svg style="width: 100%; height: 100%;" width="45" height="45" viewBox="0 0 45 45" stroke="#fff">\n    <g fill="none" fill-rule="evenodd" transform="translate(1 1)" stroke-width="2">\n      <circle cx="22" cy="22" r="6" stroke-opacity="0">\n        <animate attributeName="r"\n              begin="1.5s" dur="3s"\n              values="6;22"\n              calcMode="linear"\n              repeatCount="indefinite" />\n        <animate attributeName="stroke-opacity"\n              begin="1.5s" dur="3s"\n              values="1;0" calcMode="linear"\n              repeatCount="indefinite" />\n        <animate attributeName="stroke-width"\n              begin="1.5s" dur="3s"\n              values="2;0" calcMode="linear"\n              repeatCount="indefinite" />\n      </circle>\n      <circle cx="22" cy="22" r="6" stroke-opacity="0">\n        <animate attributeName="r"\n              begin="3s" dur="3s"\n              values="6;22"\n              calcMode="linear"\n              repeatCount="indefinite" />\n        <animate attributeName="stroke-opacity"\n              begin="3s" dur="3s"\n              values="1;0" calcMode="linear"\n              repeatCount="indefinite" />\n        <animate attributeName="stroke-width"\n              begin="3s" dur="3s"\n              values="2;0" calcMode="linear"\n              repeatCount="indefinite" />\n      </circle>\n      <circle cx="22" cy="22" r="8">\n        <animate attributeName="r"\n              begin="0s" dur="1.5s"\n              values="6;1;2;3;4;5;6"\n              calcMode="linear"\n              repeatCount="indefinite" />\n      </circle>\n    </g>\n  </svg>\n  ',download:'\n  <svg height="19px" viewBox="0 0 14 19" width="14px" xmlns="http://www.w3.org/2000/svg">\n    <title/><desc/><defs/>\n    <g fill="none" fill-rule="evenodd" id="Page-1" stroke="none" stroke-width="1">\n      <g fill="#000000" id="Core" transform="translate(-383.000000, -213.000000)">\n        <g id="file-download" transform="translate(383.000000, 213.500000)">\n          <path d="M14,6 L10,6 L10,0 L4,0 L4,6 L0,6 L7,13 L14,6 L14,6 Z M0,15 L0,17 L14,17 L14,15 L0,15 L0,15 Z" id="Shape"/>\n        </g>\n      </g>\n    </g>\n  </svg>\n  '};var h=y;var v=class{constructor(e={}){this.options=Object.assign({dpi:300,attribution:"© OpenStreetMap Contributors",textFont:[]},e)}onAdd(e){this.container=document.createElement("div"),this.container.className="mapboxgl-ctrl mapboxgl-ctrl-group";const t=document.createElement("button");return t.className="mapboxgl-ctrl-icon mapbox-gl-download",t.type="button",t.setAttribute("aria-label","Download"),t.innerHTML=h.download,this.container.appendChild(t),t.addEventListener("click",()=>{const t=window.devicePixelRatio;Object.defineProperty(window,"devicePixelRatio",{get:()=>this.options.dpi/96});const n=this.loading(),o=document.createElement("div");document.body.appendChild(o);const i=e.getContainer().offsetWidth,r=e.getContainer().offsetHeight,a=e.unproject([i,r]).toArray();this.setStyles(o,{visibility:"hidden",position:"absolute",top:0,bottom:0,width:i+"px",height:r+"px"});let l,c=[];e.style.glyphManager&&e.style.glyphManager.localIdeographFontFamily&&(c=e.style.glyphManager.localIdeographFontFamily),l=void 0!==window.geolonia?window.geolonia.Map:mapboxgl.Map;const s=new l({container:o,center:e.getCenter(),zoom:e.getZoom(),bearing:e.getBearing(),pitch:e.getPitch(),style:e.getStyle(),localIdeographFontFamily:c,hash:!1,preserveDrawingBuffer:!0,interactive:!1,attributionControl:!1});s.once("load",()=>{const i={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:a},properties:{text:this.options.attribution}}]};s.addSource("attribution-for-image",{type:"geojson",data:i});let r=[];if(this.options.textFont.length)r=this.options.textFont;else{const t=e.getStyle().layers;for(let n=0;n<t.length;n++)try{const o=e.getLayoutProperty(t[n].id,"text-font");if(o&&o.length){r=o;break}}catch(e){}}s.addLayer({id:"markers",type:"symbol",source:"attribution-for-image",paint:{"text-color":"#000000","text-halo-color":"rgba(255, 255, 255, 1)","text-halo-width":2},layout:{"text-field":"{text}","text-font":r,"text-size":18,"text-anchor":"bottom-right","text-max-width":28,"text-offset":[-.5,-.5],"text-allow-overlap":!0}}),setTimeout(()=>{s.getCanvas().toBlob(e=>{m.a.saveAs(e,s.getCenter().toArray().join("-")+".png"),s.remove(),o.parentNode.removeChild(o),n.parentNode.removeChild(n),Object.defineProperty(window,"devicePixelRatio",{get:()=>t})})},3e3)})}),this.container}onRemove(){this.container.parentNode.removeChild(this.container)}loading(){const e=document.createElement("div");document.body.appendChild(e),this.setStyles(e,{position:"absolute",top:0,bottom:0,width:"100%",backgroundColor:"rgba(0, 0, 0, 0.6)",zIndex:9999});const t=document.createElement("div");return t.innerHTML=h.loading,this.setStyles(t,{position:"absolute",top:0,bottom:0,left:0,right:0,zIndex:9999,margin:"auto",width:"120px",height:"120px"}),e.appendChild(t),e}setStyles(e,t){for(const n in t)e.style[n]=t[n]}};const w=new geolonia.Map("#map"),b=new MapboxDraw({controls:{point:!1,polygon:!1,combine_features:!1,uncombine_features:!1},styles:[{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#e74230","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}}]}),x=new v({dpi:300,attribution:"© Geolonia © OpenStreetMap Contributors"});w.addControl(b,"top-right"),w.addControl(x),w.on("load",async()=>{const e=(()=>{let e;document.getElementById("url").value=window.location.href;const t=r.get("g");if(t){try{e=t.split(";").map(e=>e.split(",").map(e=>parseFloat(e)))}catch(e){console.error(e)}if(e){const t={type:"LineString",coordinates:e};try{return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]}}catch(e){return console.error(e),null}}}})(),t=e=>{if(e){w.getSource("app-vertice")&&(w.removeLayer(o.id),w.removeLayer("app-end-circle"),w.removeSource("app-vertice")),w.addSource("app-vertice",{type:"geojson",data:e}),w.addLayer(o),w.addLayer(i)}else w.removeLayer(o.id),w.removeLayer("app-end-circle"),w.removeSource("app-vertice")};if(e){b.set(e);const n=e.features[0],{distance:o,vertice:i}=await l(n.geometry);t(i),setMarker(n),f(o)}p("trail",!0,1e3),w.on("draw.create",async e=>{const n=e.features[0];b.deleteAll(),b.set({type:"FeatureCollection",features:[n]}),p("trail",!1),p("copied",!1),p("copy",!0,1e3);const{distance:o,vertice:i}=await l(n.geometry);a(n),t(i),f(o)}),w.on("draw.update",async e=>{if("move"===e.action||"change_coordinates"===e.action){p("trail",!1);const e=b.getAll().features[0],{distance:n,vertice:o}=await l(e.geometry);a(e),t(o),f(n)}}),w.on("draw.delete",()=>{t(!1),p("copied",!1),p("copy",!1),p("trail",!0,1e3)})})}]);